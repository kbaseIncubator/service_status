(this.webpackJsonpkbase_service_watcher=this.webpackJsonpkbase_service_watcher||[]).push([[0],{10:function(e){e.exports=JSON.parse('{"environments":{"ci":{"name":"CI","prefix":"ci"},"next":{"name":"Next","prefix":"next"},"prod":{"name":"Production","prefix":""},"appdev":{"name":"AppDev","prefix":"appdev"}},"env_order":["prod","appdev","next","ci"],"services":{"ujs":{"name":"User and Job State","path":"userandjobstate","type":"jsonrpc","module":"UserAndJobState","method":"ver"},"service_wizard":{"name":"Service Wizard","path":"service_wizard","type":"jsonrpc","module":"ServiceWizard","method":"version"},"narrative_service":{"name":"Narrative Service","module":"NarrativeService","path":"service_wizard","type":"dynamic","method":"status"},"feeds":{"name":"Feeds","module":"Feeds","path":"feeds","type":"rest","method":"/"},"ee2":{"name":"Execution Engine 2","path":"ee2","type":"jsonrpc","method":"status","module":"execution_engine2"},"relation_engine_api":{"name":"Relation Engine API","path":"relation_engine_api","type":"rest","method":"/","module":"RelationEngineAPI"},"auth":{"name":"Authentication","path":"auth","type":"rest","module":"Auth","method":"/"},"workspace":{"name":"Workspace","path":"ws","type":"jsonrpc","module":"Workspace","method":"ver"},"njs_wrapper":{"name":"NJS Wrapper","path":"njs_wrapper","type":"jsonrpc","module":"NarrativeJobService","method":"ver"},"handle_service2":{"name":"Handle Service","path":"handle_service","type":"jsonrpc","module":"AbstractHandle","method":"status"},"catalog":{"name":"Catalog","path":"catalog","type":"jsonrpc","module":"Catalog","method":"version"},"fake":{"name":"Fake Service","path":"fake_service","type":"jsonrpc","module":"Fake","method":"status"}}}')},17:function(e,t,r){},20:function(e,t,r){e.exports=r(37)},25:function(e,t,r){},26:function(e,t,r){},35:function(e,t,r){},36:function(e,t,r){},37:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),s=r(18),c=r.n(s),o=(r(25),r(7)),i=(r(26),r(10)),u=r(2),l=r.n(u),p=r(5),h=r(3),m=r(4),d=function(){function e(t){Object(h.a)(this,e),this.url=t}return Object(m.a)(e,[{key:"makeCall",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"GET",cache:"no-cache",headers:{"Content-type":"application/json; charset=utf8"},redirect:"follow",referrer:"no-referrer",maxRedirects:5},e.next=3,fetch(this.url+t,r);case 3:if(n=e.sent,console.warn(n),n.ok){e.next=7;break}throw new Error("Error while contacting service");case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),v=r(12),f=r.n(v),b=function(){function e(t,r){Object(h.a)(this,e),this.url=t,this.mod=r}return Object(m.a)(e,[{key:"makeCall",value:function(){var e=Object(p.a)(l.a.mark((function e(t,r){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",cache:"no-cache",headers:{Accept:"application/json"},redirect:"follow",referrer:"no-referrer",maxRedirects:5,body:JSON.stringify({id:f()(),version:"1.1",method:"".concat(this.mod,".").concat(t),params:r?[r]:[]})},e.next=3,fetch(this.url,n);case 3:if((a=e.sent).ok){e.next=7;break}throw console.log(a),new Error("Bad response from service");case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),j=r(8),k=r(6),w=r(19),O=r(9),y=function(e){function t(e,r){var n;return Object(h.a)(this,t),(n=Object(j.a)(this,Object(k.a)(t).call(this,e,r))).serviceWizardUrl=e,n}return Object(O.a)(t,e),Object(m.a)(t,[{key:"makeCall",value:function(){var e=Object(p.a)(l.a.mark((function e(r,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getServiceUrl();case 2:return a=e.sent,this.url=a.result[0].url,e.abrupt("return",Object(w.a)(Object(k.a)(t.prototype),"makeCall",this).call(this,r,n));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getServiceUrl",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json; charset=utf-8"},redirect:"follow",referrer:"no-referrer",maxRedirects:5,body:JSON.stringify({id:f()(),version:"1.1",method:"ServiceWizard.get_service_status",params:[{module_name:this.mod,version:null}]})},e.next=3,fetch(this.serviceWizardUrl,t);case 3:if((r=e.sent).ok){e.next=6;break}throw new Error("Error while looking up dynamic service URL");case 6:return e.next=8,r.json();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(b),g=function(){function e(t){switch(Object(h.a)(this,e),this.options=t,this.client=null,t.type){case"rest":this.client=new d(t.url);break;case"jsonrpc":this.client=new b(t.url,t.module);break;case"dynamic":this.client=new y(t.url,t.module)}}return Object(m.a)(e,[{key:"getStatus",value:function(){var e=Object(p.a)(l.a.mark((function e(t,r){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("calling out to "+this.options.url),e.next=3,this.client.makeCall(t,r);case 3:return n=e.sent,e.prev=4,e.next=7,n.clone().json();case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(4),e.next=14,n.text();case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),x=(r(30),r(13)),E=(r(17),function(e){function t(e){var r;return Object(h.a)(this,t),(r=Object(j.a)(this,Object(k.a)(t).call(this,e))).state={status:"starting"},r}return Object(O.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){switch(this.state.status){case"ok":return a.a.createElement(x.a,{icon:"thumbs-up",className:"status-icon icon-ok"});case"error":return a.a.createElement(x.a,{icon:"bomb",className:"status-icon icon-error"});default:return a.a.createElement(x.a,{icon:"spinner",pulse:!0,className:"status-icon icon-loading"})}}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.status!==t.status?{status:e.status}:null}}]),t}(a.a.Component)),S=(r(35),function(e){function t(e){var r;return Object(h.a)(this,t),(r=Object(j.a)(this,Object(k.a)(t).call(this,e))).state={view:!1},r}return Object(O.a)(t,e),Object(m.a)(t,[{key:"updateResponse",value:function(e){try{e=JSON.stringify(e,null,2)}catch(t){}return e}},{key:"render",value:function(){if(!this.state.view)return a.a.createElement("div",null);var e=this.updateResponse(this.props.response);return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",{className:"response-url"}," ",this.props.url," "),a.a.createElement("pre",{className:"response-area"},e))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.view!==t.view?{view:e.view}:null}}]),t}(a.a.Component));function _(e){var t=Object(n.useState)("updating"),r=Object(o.a)(t,2),s=r[0],c=r[1],i=Object(n.useState)(null),u=Object(o.a)(i,2),h=u[0],m=u[1],d=Object(n.useState)(!1),v=Object(o.a)(d,2),f=v[0],b=v[1],j=new g(e);function k(e,t){m(e),c(t)}return Object(n.useEffect)((function(){var t=!1;function r(){return(r=Object(p.a)(l.a.mark((function r(){var n,a;return l.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return k("","updating"),r.prev=1,r.next=4,j.getStatus(e.method);case 4:n=r.sent,t||k(n,"ok"),r.next=15;break;case 8:r.prev=8,r.t0=r.catch(1),a={attemptedCall:e.method,url:e.url},r.t0.message&&(a.message=r.t0.message),r.t0.stack&&(a.stack=r.t0.stack),t||k(a,"error"),console.error(r.t0);case 15:case"end":return r.stop()}}),r,null,[[1,8]])})))).apply(this,arguments)}return function(){r.apply(this,arguments)}(),function(){t=!0}}),[e.url]),a.a.createElement("div",{className:"kb-service-status ".concat(s)},a.a.createElement("div",{className:"status-flex",onClick:function(){b(!f)}},a.a.createElement("div",null,e.name),a.a.createElement("a",{className:"status-button"},a.a.createElement(E,{status:s}))),a.a.createElement(S,{view:f,response:h,url:e.url}))}r(36);function N(e){var t=Object(n.useState)(0),r=Object(o.a)(t,2),s=r[0],c=r[1],i=e.envOrder.map((function(t,r){var n=r===s?"selected":"";return a.a.createElement("span",{className:n,key:r,onClick:function(){return function(t){c(t),e.updater(e.envOrder[t])}(r)}},e.envs[t].name)}));return a.a.createElement("div",{className:"env-list"},i)}var C=function(){var e=Object(n.useState)("prod"),t=Object(o.a)(e,2),r=t[0],s=t[1],c=i.environments,u=i.env_order,l=Object.keys(i.services).sort(),p="https://"+(c[r].prefix?c[r].prefix+".":"")+"kbase.us/services/",h=l.map((function(e){var t=i.services[e];return t.key=e,t.url=p+t.path,a.a.createElement(_,t)}));return console.log(h),a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement(N,{envs:c,envOrder:u,updater:function(e){s(e)}})),a.a.createElement("div",{className:"status-area"},h))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[20,1,2]]]);
//# sourceMappingURL=main.53e51dda.chunk.js.map